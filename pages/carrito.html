<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carrito - Zona Gaming</title>

    <link rel="stylesheet" href="../css/style.css" />
  </head>

  <body>
    <header>
      <h1 class="site-title">Carrito</h1>
      <div class="header-right">
        <a href="../index.html" class="contact-link">⬅</a>
      </div>
    </header>

    <main>
      <h2 class="subtitle">Tu Carrito</h2>

      <section id="cart-items"></section>

      <div class="form-section">
        <h2>Total: $<span id="total-price">0</span></h2>
        <button class="price-btn" id="buy-btn">Comprar</button>
      </div>
    </main>

    <footer>
      <p>© 2025 ehlarmv - Todos los derechos reservados</p>
    </footer>

    <script src="../js/cart.js"></script>

    <script>
      function renderCart() {
        const container = document.getElementById("cart-items");
        const totalPrice = document.getElementById("total-price");
        container.innerHTML = "";
        let total = 0;

        if (!cart || cart.length === 0) {
          container.innerHTML =
            "<p style='text-align:center;'>Tu carrito está vacío</p>";
          totalPrice.textContent = "0";
          return;
        }

        cart.forEach((item, index) => {
          total += item.price * item.quantity;

          const div = document.createElement("div");
          div.classList.add("cart-item");

          div.innerHTML = `
            <!-- CORREGIDO -->
            <img src="../${item.img}" alt="${item.name}" />
            <div class="cart-info">
              <p><strong>${item.name}</strong></p>
              <p>Precio: $${item.price}</p>
              <p>Cantidad: ${item.quantity}</p>
              <div class="cart-actions">
                <button class="price-btn decrease-btn" data-index="${index}">➖</button>
                <button class="price-btn increase-btn" data-index="${index}">➕</button>
                <button class="price-btn remove-btn" data-index="${index}">❌ Eliminar</button>
              </div>
            </div>
          `;

          container.appendChild(div);
        });

        totalPrice.textContent = total;

        document.querySelectorAll(".remove-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            const i = Number(btn.dataset.index);
            cart.splice(i, 1);
            saveCart();
            updateCartCount();
            renderCart();
          });
        });

        document.querySelectorAll(".increase-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            const i = Number(btn.dataset.index);
            cart[i].quantity++;
            saveCart();
            updateCartCount();
            renderCart();
          });
        });

        document.querySelectorAll(".decrease-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            const i = Number(btn.dataset.index);
            if (cart[i].quantity > 1) {
              cart[i].quantity--;
            } else {
              cart.splice(i, 1);
            }
            saveCart();
            updateCartCount();
            renderCart();
          });
        });
      }

      document.getElementById("buy-btn").addEventListener("click", () => {
        localStorage.removeItem("cart");
        cart = [];
        updateCartCount();
        window.location.href = "../index.html";
      });

      renderCart();
    </script>
  </body>
</html>
